services:
  app:
    build:
      context: .
      args:
        USER_ID: ${USER_ID}
        GROUP_ID: ${GROUP_ID}
    image: ruby-dev-env
    container_name: ruby-dev-container
    init: true
    volumes:
      # Use an absolute path if this compose file is in a fixed location, 
      # or '.' if it stays in the project root.
      - ./src:/app
      - ./container-state/.local:/home/devuser/.local
    stdin_open: true
    tty: true
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 2G
        reservations:
          memory: 512M
    network_mode: bridge
    restart: always

